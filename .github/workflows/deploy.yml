name: Deploy to PythonAnywhere

on:
  push:
    branches: ["main"]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Install wheel package
        run: pip install wheel

      - name: Install PythonAnywhere CLI
        run: pip install --upgrade --no-build-isolation --no-cache-dir pythonanywhere-cli

      - name: Upload to PythonAnywhere
        run: |
          python -m pythonanywhere.deploy \
            --username "${{ secrets.PA_USERNAME }}" \
            --api_token "${{ secrets.PA_API_TOKEN }}" \
            --path . \
            --target /home/orderd/mysite \
            --domain orderd.pythonanywhere.com
